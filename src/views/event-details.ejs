<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title><%= event.name %> — Event Details</title>
  <link rel="stylesheet" href="/css/cards.css" />
  <style>
    .carousel {
      position: relative;
      overflow: hidden;
    }
    .carousel-slide {
      display: none;
      text-align: center;
    }
    .carousel-slide.active {
      display: block;
    }
    .carousel-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background-color: rgba(0,0,0,0.5);
      color: white;
      border: none;
      padding: 8px 12px;
      cursor: pointer;
      z-index: 2;
    }
    .carousel-btn.prev {
      left: 10px;
    }
    .carousel-btn.next {
      right: 10px;
    }
    .carousel img, .carousel video {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div class="event-detail">

    <!-- Event Title -->
    <header>
      <h1><%= event.name %></h1>
    </header>

    <!-- Media Carousel -->
    <% if (media && media.length) { %>
      <section class="carousel-wrapper">
        <div class="carousel" id="mediaCarousel">
          <% media.forEach((m, index) => { %>
            <div class="carousel-slide <%= index === 0 ? 'active' : '' %>">
              <% if (m.mediaType === 'image') { %>
                <img src="<%= m.url %>" alt="Image for <%= event.name %>">
              <% } else if (m.mediaType === 'video') { %>
                <video src="<%= m.url %>" controls></video>
              <% } %>
            </div>
          <% }) %>
          <button class="carousel-btn prev" onclick="prevSlide()">❮</button>
          <button class="carousel-btn next" onclick="nextSlide()">❯</button>
        </div>
      </section>
    <% } %>

    <!-- Date and Place -->
    <section class="date-place">
      <p><%= event.date.toDateString() %> | <%= event.place %></p>
    </section>

    <!-- Description -->
    <section class="description">
      <h2>Description</h2>
      <p><%= event.description %></p>
    </section>

    <!-- Artists -->
    <% if (event.artists && event.artists.length) { %>
      <section class="artists">
        <h2>Artists</h2>
        <ul>
          <% event.artists.forEach(artist => { %>
            <li><%= artist %></li>
          <% }) %>
        </ul>
      </section>
    <% } %>

    <!-- Back Link -->
    <footer>
      <a href="/events" class="back-link">← Back to events</a>
    </footer>

  </div>

  <script>
    let currentIndex = 0;
    const slides = document.querySelectorAll(".carousel-slide");

    function showSlide(index) {
      slides.forEach((slide, i) => {
        slide.classList.toggle("active", i === index);
      });
    }

    function prevSlide() {
      currentIndex = (currentIndex - 1 + slides.length) % slides.length;
      showSlide(currentIndex);
    }

    function nextSlide() {
      currentIndex = (currentIndex + 1) % slides.length;
      showSlide(currentIndex);
    }

    // Auto-advance every 4 seconds
    setInterval(nextSlide, 4000);
  </script>
</body>
</html>
